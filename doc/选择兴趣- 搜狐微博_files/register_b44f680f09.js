kola("newt.user.register.Active",["jquery.Core","newt.dialog.Notice","newt.ca.ca"],function(){$("[data-ca]").live("click",function(){CA($(this).attr("data-ca"))});var a=function(c){var b=this;b.opts=$.extend({mail:"",sendBtn:"#sendBtn",checkBtn:"#checkBtn"},c||{});$.extend(b,{init:function(){$(function(){kola("newt.ca.pv",function(d){d()})});b.sendBtn=$(b.opts.sendBtn);b.sendBtn.click(function(){b.sendMail(b.opts.mail)});b.checkBtn=$(b.opts.checkBtn);b.checkBtn.click(function(){b.checkMailStatus(b.opts.mail)})},sendMail:function(d){var e;e={mail:d};if(d==""){return}b.ajax(e,"/regist/resendMail",{okHandle:function(f){if(f.status==0){tw.notice.showTip("发送成功")}else{tw.notice.alert(f.statusText)}},errHandle:function(f,g){tw.notice.alert("服务器通讯失败，请稍后再试")}})},checkMailStatus:function(d){var e;e={mail:d};if(d==""){return}b.ajax(e,"/regist/checkAccountState",{okHandle:function(f){if(f){tw.notice.alert(f.statusText)}else{tw.notice.alert("操作失败")}},errHandle:function(f,g){tw.notice.alert("服务器通讯失败，请稍后再试")}})},ajax:function(f,d,e){$.ajax({url:d,data:f,dataType:"json",type:"post",success:function(g){if(typeof(e.okHandle)=="function"){e.okHandle(g)}},error:function(g,h){if(typeof(e.errHandle)=="function"){e.errHandle(g,h)}}})}})};return a});kola("newt.user.register.Interest",["jquery.Core","newt.window.Window"],function(c,b){var a=function(e){var d=this;d.opts=c.extend({panel:"div.recomList ul",selectedCls:"selected",selectItem:"div.recomList ul li"},e||{});d.interestArr=[];d.followArr=[];c.extend(d,{init:function(){switch(d.opts.step){case"interest":d.interestInit();break;case"follow":d.followInit();break}},interestInit:function(){d.choice();c("p.regbtn").bind("click",function(){if(c(d.opts.selectItem+"."+d.opts.selectedCls).size()<1){d.showDialog("mwMiniLess")}else{d._getInterestIds();setTimeout(function(){location.href="/regist/recommends?interest="+d.interestArr.join(",")},0)}})},followInit:function(){d.followBindEvent();c("p.regbtn").find("a.jsConcern").bind("click",function(){d.doConcern()})},choice:function(){c(d.opts.panel).bind("click",function(h){var g=c(h.target).closest("li");if(g.size()>0){var f=g.hasClass(d.opts.selectedCls);if(f){g.removeClass(d.opts.selectedCls)}else{if(c(d.opts.selectItem+"."+d.opts.selectedCls).size()>=6){d.showDialog("mwMiniMore")}else{g.addClass(d.opts.selectedCls)}}}})},_getInterestIds:function(){c(d.opts.selectItem+"."+d.opts.selectedCls).each(function(){d.interestArr.push(c(this).attr("uinterest"))})},followBindEvent:function(){c("div.uListSelect").bind("click",function(h){var g=c(h.target).closest("div.uSelectItem");if(g.size()>0){var f=g.hasClass("selected");if(f){g.removeClass("selected")}else{g.addClass("selected")}}})},_getFollowIds:function(){c("div.uListSelect").find("div.uSelectItem.selected").each(function(){d.followArr.push(c(this).attr("uid"))})},doConcern:function(){d._getFollowIds();kola("newt.service.Follows",function(f){f.follow({params:{uids:d.followArr},success:function(g){if(g.status==0){setTimeout(function(){location.href="/home"},0)}else{kola("newt.dialog.Notice",function(){tw.notice.alert("关注失败")})}}})})},showDialog:function(h){if(c("#jsShowDialog").length==0){var g='<div id="jsShowDialog" class="mw mwMini" style="margin-left: -148px;"><div class="mwCt"></div></div>';if(c("div.SKY").length>0){c(g).appendTo("div.SKY")}else{c(g).prependTo(document.body)}}c("#jsShowDialog").removeClass("mwMiniMore mwMiniLess").addClass(h);var f=c("#jsShowDialog").overlay({top:"center",speed:true,closeSpeed:true,closeOnClick:false,api:true}).load();setTimeout(function(){f.close()},1000)}})};return a});kola("newt.user.register.Mobile",["jquery.Core","newt.plug.RadioClass","newt.data.Rule","newt.service.Account","newt.dialog.Notice","newt.ca.ca"],function(d,e,c,b){var a=function(h){var g=this;g.opts=d.extend({panelReg:"#mobilereg_form1",panelVad:"#mobilereg_form2",redUrl:"http://t.sohu.com/regist/recommends"},h||{});g.mobile=d(g.opts.panelReg).find("input:eq(0)");g.pwd=d(g.opts.panelReg).find("input:eq(1)");g.VCode=d(g.opts.panelVad).find("input:eq(0)");function f(i){CA.q("newt_regist_mobile_"+i)}d.extend(g,{init:function(){g.initTab();g.checkMobile();g.checkPwd();g.checkVCode();d(g.opts.panelReg).find("a.jsBtnReg").click(function(){f("doReg_click");g.doReg()});d(g.opts.panelVad).find("a.jsReturn").click(function(){f("changeMobile_click");g.switchPanel("reg")});d(g.opts.panelVad).find("a.jsBtnValid").click(function(){f("doValid_click");g.doValid()});d(g.opts.panelVad).find("a.jsBtnGetCode").click(function(){f("getVCode_click");g.getValidCode(function(){g.switchCodeTip("codeTip")})})},initTab:function(){d("#reg_content").find("ul").RadioClass({tag:"a",focusClass:"on",afterclick:function(i){var j=i.attr("id").split("_")[1];d("div.form").addClass("noDis");d("#tabC_"+j).removeClass("noDis");if(j==2){f("click_tab")}}})},checkMobile:function(){var i=g.mobile;g.showTip(i,"","手机号为你的微博登录名(暂不支持海外手机注册)");i.focus(function(){d(this).closest("i").removeClass("blur");g.showTip(d(this),"","手机号为你的微博登录名(暂不支持海外手机注册)")}).blur(function(){d(this).closest("i").addClass("blur");g.showTip(d(this),"","手机号为你的微博登录名(暂不支持海外手机注册)");var j=d.trim(d(this).val());if(j==""){return}if(!c.test("required",j)){g.showTip(d(this),"err","手机号码不能为空")}else{if(j.length!=11||!c.test("number",j)){g.showTip(d(this),"err","手机号码格式错误")}else{g.ajaxMobile()}}f("enter_mobile")}).keyup(function(){var j=d.trim(d(this).val());if(!c.test("l0l11",j)||!c.test("number",j)){g.showTip(d(this),"err","手机号码格式错误")}})},checkPwd:function(){var i=g.pwd;i.focus(function(){d(this).closest("i").removeClass("blur");g.showTip(d(this),"","6-16位，由字母（区分大小写）、数字、符号组成")}).blur(function(){d(this).closest("i").addClass("blur");g.showTip(d(this),"","");var j=d.trim(d(this).val());if(j==""){return}if(!c.test("required",j)){g.showTip(d(this),"err","请填写密码")}else{if(!c.test("password",j)){g.showTip(d(this),"err","密码必须是字母(区分大小写)、数字、符号")}else{if(j.length<6||j.length>16){g.showTip(d(this),"err","长度需要在6-16位之间")}else{g.showTip(d(this),"ok","");f("enter_pwd_pass")}}}f("enter_pwd")}).keyup(function(){var j=d.trim(d(this).val());if(!c.test("password",j)){g.showTip(d(this),"err","6-16位，由字母（区分大小写）、数字、符号组成")}})},checkVCode:function(){var i=g.VCode;i.focus(function(){d(this).closest("i").removeClass("blur");g.showTip(d(this),"","请输入验证码")}).blur(function(){d(this).closest("i").addClass("blur");g.showTip(d(this),"","");var j=d.trim(d(this).val());if(j==""){return}if(!c.test("required",j)){g.showTip(d(this),"err","验证码不能为空")}else{if(j.length!=4){g.showTip(d(this),"err","验证码输入错误")}}f("enter_vCode")})},ajaxMobile:function(){b.phoneNumberRegistAllow({params:{phoneNumber:g.mobile.val()},success:function(i){if(i.status==0){g.showTip(g.mobile,"ok","")}else{g.showTip(g.mobile,"err",i.statusText)}}})},showTip:function(l,j,m){var i,k;i=l.closest(".frm");k=i.find(".frmTip b");i.removeClass("frm_err").removeClass("frm_ok");switch(j){case"ok":i.addClass("frm_ok");break;case"err":i.addClass("frm_err");break}if(typeof(m)!="undefined"){k.html(m)}},switchPanel:function(i){d(g.opts.panelReg).addClass("noDis");d(g.opts.panelVad).addClass("noDis");switch(i){case"reg":d(g.opts.panelReg).removeClass("noDis");g.showTip(g.mobile,"","");g.showTip(g.pwd,"","");g.pwd.val("");g.mobile.select();break;case"valid":d(g.opts.panelVad).removeClass("noDis");d(g.opts.panelVad).find(".jsMobile").html(g.mobile.val());g.VCode.focus();break}},switchCodeTip:function(i){var j=d(g.opts.panelVad);j.find(".jsReGetCode").addClass("noDis");j.find(".jsCodeTip").addClass("noDis");switch(i){case"getCode":j.find(".jsReGetCode").removeClass("noDis");break;case"codeTip":j.find(".jsCodeTip").removeClass("noDis");g.setTimer();break}},setTimer:function(){var j,i=60;j=d(g.opts.panelVad).find(".jsCodeTip span");clearInterval(g.InterId);j.html(i+"秒 ");g.InterId=setInterval(function(){i=i-1;j.html(i+"秒 ");if(i==0){clearInterval(g.InterId);g.switchCodeTip("getCode")}},1000)},getValidCode:function(i){f("vCode_get");b.getPhoneNumberVCode({params:{phoneNumber:d.trim(g.mobile.val())},success:function(j){if(j.status==0){f("vCode_suc");if(typeof(i)=="function"){i()}}else{f("vCode_err");tw.notice.alert(j.statusText)}}})},doReg:function(){var j,k,i=true;j=d.trim(g.mobile.val());if(!c.test("required",j)){g.showTip(g.mobile,"err","手机号码不能为空");i=false}else{if(j.length!=11||!c.test("number",j)){g.showTip(g.mobile,"err","手机号码格式错误");i=false}else{if(g.mobile.closest(".frm").hasClass("frm_err")){i=false}else{g.showTip(g.mobile,"ok","")}}}k=d.trim(g.pwd.val());if(!c.test("required",k)){g.showTip(g.pwd,"err","请填写密码");i=false}else{if(!c.test("password",k)){g.showTip(g.pwd,"err","密码必须是字母(区分大小写)、数字、符号");i=false}else{if(k.length<6||k.length>16){g.showTip(g.pwd,"err","长度需要在6-16位之间");i=false}else{g.showTip(g.pwd,"ok","")}}}if(!i){return}f("doReg");g.getValidCode(function(){g.switchPanel("valid");g.switchCodeTip("getCode")})},doValid:function(){var j,i=true;j=d.trim(g.VCode.val());if(!c.test("required",j)){g.showTip(g.VCode,"err","验证码不能为空");i=false}else{if(j.length!=4){g.showTip(g.VCode,"err","验证码输入错误");i=false}}if(!i){return}f("doValid");b.registByPhoneNumber({params:{phoneNumber:d.trim(g.mobile.val()),password:d.trim(g.pwd.val()),vCode:j,returnUrl:g.opts.redUrl},success:function(k){if(k.status==0){f("doValid_suc");location.href=k.statusText}else{f("doValid_err");tw.notice.alert(k.statusText)}}})}})};return a});kola("newt.user.register.Recommend",["newt.friend.Recommend","newt.tool.Url","newt.cr.cr","newt.ca.ca"],function(c){function b(d){CA.q("newt3_register_step3_recommend_"+d)}$("[data-ca]").live("click",function(){b($(this).attr("data-ca"))});var a=function(e){var d=this;d.opts=$.extend({redirectUrl:"/home",panel:"#recommendList",selectPanel:"div.uListSelect",selectSel:"div.uSelectItem",selectedCls:"selected",perUSize:10},e||{});d.reUrl=d.opts.redirectUrl;$.extend(d,{init:function(){$(function(){kola("newt.ca.pv",function(h){h()})});$(function(){b("pageload")});var f=$.url.param("isActive");if(f==1){b("activeSuccess");tw.notice.showTip2("邮箱验证成功","现在去找找感兴趣的人吧!")}var g=$.cr.cookie.get("active_rewrite");if(!g){g=d.opts.redirectUrl}$("a.jsSkip").attr("href",g);d.reUrl=g;d._bindEvent()},_bindEvent:function(){var f,h,g;f=$(d.opts.panel);h=f.find("input");g=f.find("a.jsConcern");f.click(function(k){var j=$(k.target).closest(d.opts.selectSel);if(j.size()>0){var i=j.hasClass(d.opts.selectedCls);if(i){j.removeClass(d.opts.selectedCls)}else{j.addClass(d.opts.selectedCls)}d._changeCheckBoxStatus(j)}});h.click(function(){var i,j;i=this.checked;j=$(this).closest(d.opts.selectPanel);if(i){j.find(d.opts.selectSel).addClass(d.opts.selectedCls)}else{j.find(d.opts.selectSel).removeClass(d.opts.selectedCls)}});h.each(function(){$(this).attr("checked",true)});g.click(function(){d.doConcern()})},_changeCheckBoxStatus:function(i){var h,f,g;h=i.closest(d.opts.selectPanel);g=h.find("input");f=h.find(d.opts.selectSel+"."+d.opts.selectedCls).size();if(f==d.opts.perUSize){g.attr("checked",true)}else{g.removeAttr("checked")}},_getSelUserIds:function(){var f=[];$(d.opts.panel).find(d.opts.selectSel+"."+d.opts.selectedCls).each(function(){f.push($(this).attr("uid"))});return f},doConcern:function(){var f=d._getSelUserIds();kola("newt.service.Follows",function(g){g.follow({params:{uids:f},success:function(h){if(h.status==0){location.href=d.reUrl}else{kola("newt.dialog.Notice",function(){tw.notice.alert("关注失败")})}}})})}})};return a});kola("newt.user.register.Registauth",["jquery.Core"],function(){var a={init:function(){var c="1";var b="";kola("newt.settings.BindMobile",function(d){var e=new d(c,b);e.init()})},tab:function(b){if($(b.ele).hasClass("fuc_dis")){return false}$("a.js_type_btn").removeClass("fuc_dis");$(b.ele).addClass("fuc_dis");$("div.hint .js_type").addClass("noDis");$("div.hint .js_"+b.type).removeClass("noDis")}};return a});kola("newt.user.register.logic",["jquery.Core","newt.net.interface.user","newt.util.Validator","newt.data.Rule","newt.Config","newt.widget.AutoComplete","newt.widget.ConnectLogin","newt.iploc.CrIploc1","newt.cr.cr","newt.ca.ca"],function(i,A,o,t,r,z,b){t.add("包含搜狐",function(J){return J.indexOf("搜狐")==-1});t.add("包含搜狐微博",function(J){return J.indexOf("搜狐微博")==-1});t.add("包含sohu",function(J){return J.indexOf("sohu")==-1});t.add("包含souhu",function(J){return J.indexOf("souhu")==-1});t.add("开头微博",function(J){return J.indexOf("微博")!=0});t.add("开头weibo",function(J){return J.indexOf("weibo")!=0});t.add("开头官方",function(J){return J.indexOf("官方")!=0});i(function(){kola("newt.ca.pv",function(J){J()})});function k(J){CA.q("newt3_register_step1_"+J)}i("[data-ca]").live("click",function(){k(i(this).attr("data-ca"))});i(function(){k("pageload")});var a=false;i(window).bind("unload",function(){if(a){k("reg_success")}else{k("pageunload")}});b.defaultInit();function x(K){K=i.extend({success:function(){i("#captchaCode_tip").html("")}},K||{});var J=i("#validCode");if(J.size()<=0){return}A.flushValidCode(J,{beforeSend:function(){H.set("captchaCode",{remote:{enabled:false}})},success:function(L){i("#field_captchaCode").removeClass("frm_ok frm_err").find(".txt input").val("");if(typeof(K.success)=="function"){K.success()}i("#captchaSeed").val(L.data);H.set("captchaCode",{remote:{enabled:true,url:A.URL.VALID_VALIDCODE,params:"{captchaCode}&captchaSeed="+L.data,dataType:"json",dataCache:true,queueRequest:true,test:function(M){return M.status==0}}})}})}i("#field_captchaCode").find(".txt input").bind("focus",function(){if(i("#field_captchaCode").hasClass("frm_err")){x({success:function(){}})}});var D=i("#field_local");var c=[1,8];c[0]=D.find("i.select:eq(0)").attr("val");c[1]=D.find("i.select:eq(1)").attr("val");if(!c[0]||c[0]==""){c=[1,8]}if(c[0]=="请选择"){D.find("i.select:eq(0)").attr("val","0");D.find("i.select:eq(1)").attr("val","0")}if(D.find("#_province_hidden").size()==0){D.append('<input type="hidden" id="_province_hidden" class="validate-criploc" name="province" value="'+c[0]+'">');D.append('<input type="hidden" id="_city_hidden" class="validate-criploc"  name="city" value="'+c[1]+'">')}var q=i("#field_local").crIploc1({changePro:function(J){var K=i("#_province_hidden").val();if(K!=J){i("#_province_hidden").val(J);i("#_city_hidden").val(0);C("local")}},changeCity:function(J){i("#_city_hidden").val(J);f()},onLoad:function(J,K){i("#_province_hidden").val(J);i("#_city_hidden").val(K)}}).data("crIploc1");function f(){var J=i("#_province_hidden").val();var K=i("#_city_hidden").val();if(J>0&&K>0){G("local")}else{g("local","请选择您的所在地")}}var y={};function B(J){var K=y[J.VID];K=K?K:{};i.extend(K,J);y[J.VID]=K}function u(J){return y[J]}var p;function n(J){J.getTemplate({name:"template.main.regist.step1.nickname_recommend",complete:function(K){p.getData({num:6,complete:function(M){var L=i("#nickname_recommend");if(!M||M.length<=0){L.find("p.tip").html("");return}var N=(i.trim(L.html())=="");L.html(K.render({data:M})).hide();if(M.length<6){L.find("p.tip").html("")}if(N){L.slideDown(100)}else{L.show()}L.find("a.js-next").bind("click",function(){n(J)});L.find("input.js-nickname").bind("click",function(){i("input[name='nickname']").val(i(this).attr("data-nickname"));i("#field_nickname").removeClass("frm_err").addClass("frm_ok");C("nickname");L.fadeOut(100,function(){i("#nickname_recommend").html("")})})}})}})}function j(J){kola("util.data.DataBuffer, mvc.view.TemplateEngine",function(L,K){p=new L({bufferSize:J.length,filler:function(N,O,M){M(J.splice(0,O))}});n(K)})}var d=i("#reg_form");var E="";var e="";var I=null;var m=0;var H=new o({form:d,rules:{mail:{remote:{enabled:true,url:A.URL.VALID_EMAIL,params:"{mail}",dataType:"json",dataCache:true,queueRequest:true,test:function(J){e=J.statusText;return J.status==0}}},nickname:{"包含搜狐":{enabled:true},"包含搜狐微博":{enabled:true},"包含sohu":{enabled:true},"包含souhu":{enabled:true},"开头微博":{enabled:true},"开头weibo":{enabled:true},"开头官方":{enabled:true},remote:{enabled:true,url:A.URL.VALID_NICKNAME,getters:{getMail:function(){return s()}},params:"{nickname}&mail={=getMail}",dataType:"json",dataCache:false,queueRequest:true,test:function(J){E=J.statusText;if(J.status==1&&J.data.length>0){j(J.data)}else{i("#nickname_recommend").html("")}return J.status==0}}}},validateListener:function(J,L,O){var K=false;if(O){B(L)}var P=L.VID;var N=u(P);if(N){i.extend(L,N)}for(var S in L){if(S=="VID"){continue}if(O&&H.localPass(S)==false){break}var R=L[S];var Q=false;for(var M in R){if(Q){break}switch(M){case"包含搜狐":if(R[M]==false){g(S,"不能含有“搜狐”");i("#nickname_recommend").html("");Q=true}break;case"包含搜狐微博":if(R[M]==false){g(S,"不能含有“搜狐微博”");i("#nickname_recommend").html("");Q=true}break;case"包含sohu":if(R[M]==false){g(S,"不能含有“sohu”");i("#nickname_recommend").html("");Q=true}break;case"包含souhu":if(R[M]==false){g(S,"不能含有“souhu”");i("#nickname_recommend").html("");Q=true}break;case"开头微博":if(R[M]==false){g(S,"不能以“微博”开头");i("#nickname_recommend").html("");Q=true}break;case"开头weibo":if(R[M]==false){g(S,"不能以“weibo”开头");i("#nickname_recommend").html("");Q=true}break;case"开头官方":if(R[M]==false){g(S,"不能以“官方”开头");i("#nickname_recommend").html("");Q=true}break;case"criploc":if(R[M]==false){g("local","请选择您的所在地");k("local_no_select");Q=true}break;case"l2l12":if(R[M]==false){g(S,"长度需要在2-12位之间");k("nickname_length_error");Q=true}break;case"sohumailnamel4l16":if(R[M]==false){g(S,"邮箱名长度需要在4-16位之间");k("mail_length_error");Q=true}break;case"l6l16":if(R[M]==false){g(S,"长度需要在6-16位之间");k("pwd_length_error");Q=true}break;case"l4l16":if(R[M]==false){g(S,"邮箱名长度需要在4-16位之间");k("mailname_length_error");Q=true}break;case"required":if(R[M]==false){Q=true;switch(S){case"mail":if(v==false){if(d.find("#field_mail b.frm_suffix").size()==1){l(S,'填写常用邮箱，这将是微博帐号。<a href="javascript: void(0);" class="no-mail jsSohu">已有邮箱？</a>',false)}else{l(S,'填写常用邮箱，这将是微博帐号。<a href="javascript: void(0);" class="no-mail ">没有邮箱？</a>',false)}}else{g(S,"请填写邮箱");k("mail_novalue")}break;case"nickname":if(v==false){l(S,"2-12位，由中文、字母、数字组成");i("#nickname_recommend").html("");return}else{g(S,"请填写昵称");i("#nickname_recommend").html("");k("nickname_novalue")}break;case"password":if(v==false){l(S,"6-16位，由字母(区分大小写)、数字、符号组成");return}else{g(S,"请填写密码");k("pwd_novalue")}break;case"captchaCode":if(v==false){l(S,"输入验证码");return}else{g(S,"请填写验证码");k("validcode_novalue")}break}}break;case"email":if(R[M]==false){g(S,"邮箱格式不正确");k("mail_format_error");Q=true}break;case"remote":if(R[M]==false){Q=true;switch(S){case"mail":g(S,e);k("mail_exist");break;case"nickname":g(S,E);k("nickname_exist");break;case"captchaCode":k("validcode_error");g(S,"验证码错误");break}}break;case"nec":if(R[M]==false){g(S,"昵称只能使用中文、字母或数字");i("#nickname_recommend").html("");k("nickname_format_error");Q=true}break;case"sohumailname":if(R[M]==false){g(S,"只能使用字母、数字、减号、点号和下划线");k("sohumailname_format_error");Q=true}break;case"sohumail":if(R[M]==false){g(S,"只能使用字母、数字、减号、点号和下划线");k("sohumail_format_error");Q=true}break;case"lowercaseStart":if(R[M]==false){g(S,"只能以小写字母开头");k("mail_lowercaseStart_error");Q=true}break;case"password":if(R[M]==false){g(S,"密码必须是字母(区分大小写)、数字、符号");k("pwd_format_error");Q=true}break}}if(Q==false){k(S+"_pass");C(S);if(S=="province"||S=="city"){i("#field_local").removeClass("frm_err").addClass("frm_ok")}else{i("#field_"+S).removeClass("frm_err").addClass("frm_ok")}}else{i("#field_"+S).removeClass("frm_ok")}}if(v){v=false}},validateTriggers:"submit|blur|focus",beforeSubmit:function(){w=true;i("#loadingp").addClass("regbtnLoad");var K=i("#sohu_mail_value");if(K&&K.size()>0){d.append("<input type='hidden' name='"+K.attr("name")+"' value='"+K.val()+"@sohu.com'/>");K.removeAttr("name")}var J=d.find("input[name='password']:first");d.append("<input type='hidden' name='"+J.attr("name")+"' value='"+i.cr.encodeUTF(J.val())+"'/>");J.removeAttr("name");a=true}});function s(){var L=H.getValidateResults("mail")["mail"];for(var K in L){if(L[K]==false){return""}}var J=i("#sohu_mail_value");if(J&&J.size()>0){return J.val()+"@sohu.com"}return d.find("input[name='mail']:first").val()}d.find("input[name='nickname']").data("parser",{remote:function(J){return i.cr.encodeUTF(J)}});d.find("input[name='captchaCode']").data("parser",{remote:function(J){return i.cr.encodeUTF(J)}});d.find("input[type='text'], input[type='password']").bind("blur",function(K){if(I){var J=i("#"+this.name+"_tip");if(J.get(0)==I.get(0)){I.html("");I=null}}});i("#field_mail_input").bind("blur focus",function(){var K=i(this);var J=K.val();if(J&&J.length>0){if(t.test("atsohucommail",J)||d.find("b.frm_suffix").size()>0){H.set("mail",{sohumailnamel4l16:{enabled:false},sohumail:{enabled:false}})}else{if(t.test("atsohumail",J)){H.set("mail",{lowercaseStart:{enabled:true,priority:10},sohumailnamel4l16:{enabled:true},sohumail:{enabled:true}})}else{H.set("mail",{sohumail:{enabled:false},lowercaseStart:{enabled:false,priority:10},sohumailnamel4l16:{enabled:false}})}}}H.validate("mail")});function g(J,K){I=null;i("#field_"+J).addClass("frm_err").removeClass("frm_ok");i("#"+J+"_tip").html(K)}function G(J){I=null;i("#field_"+J).addClass("frm_ok").removeClass("frm_err")}function C(J){i("#field_"+J).removeClass("frm_err frm_ok");d.find("#"+J+"_tip").html("")}function l(K,L,J){i("#field_"+K).removeClass("frm_err frm_ok");if(J!=false){I=i("#"+K+"_tip").html(L)}else{i("#"+K+"_tip").html(L)}if(K=="nickname"){i("#nickname_recommend").html("")}}var w=false;x();i("#flushValidCode").bind("click",function(){x()});var v=false;i("#registerStart").bind("click",function(){H.cleanRemoteCache();var J=i(this);if(i("#loadingp").hasClass("regbtnLoad")){return}v=true;i("#loadingp").addClass("regbtnLoad");H.remoteAllDone(function(){if(w==false){i("#loadingp").removeClass("regbtnLoad")}});d.submit()});i(document.body).bind("keydown",function(J){if(J.keyCode==13){i("#registerStart").trigger("click")}});var F=new z({list:["@sohu.com","@163.com","@qq.com","@126.com","@hotmail.com","@gmail.com","@chinaren.com","@sogou.com","@focus.cn"],title:"请选择您的用户帐号类型",input:i("#field_mail_input"),mode:"tip"});i("#reg_content").prepend(F.getDOM().hide());var h=function(){var N,K,M,J,L=false;N=i("#field_mail");K=N.find("input[name='mail']");M=N.find("b.frm_suffix");J=i("#mail_tip");L=d.find("#field_mail b.frm_suffix").size()==0;H.set("mail",{email:{enabled:!L},lowercaseStart:{enabled:L,priority:10},l4l16:{enabled:L},sohumailname:{enabled:L}});if(L){K.attr("id","sohu_mail_value");if(M.size()==0){K.parents("i.txt").after('<b class="frm_suffix">@sohu.com</b>')}if(N.hasClass("frm_err")==false){J.html('填写常用邮箱，这将是微博帐号。<a href="javascript: void(0);" class="no-mail jsSohu">已有邮箱？</a>')}K.data("parser",{remote:function(O){return O+"@sohu.com"}});d.attr("action","/regist/newSohuRegist");F.disabled()}else{K.removeAttr("id");N.find("b.frm_suffix").remove();if(N.hasClass("frm_err")==false){J.html('填写常用邮箱，这将是微博帐号。<a href="javascript: void(0);" class="no-mail ">没有邮箱？</a>')}K.removeData("parser");d.attr("action","/regist/otherDomainRegist");F.enabled()}H.validate("mail");k("switchto_"+(L?"sohumail":"othermail"))};i("#field_mail a.no-mail").live("click",h);d.find("input[name='mail']:first").bind("blur",function(){var J=i(this);if(J.val().length>0&&t.test("atsohucommail",J.val())&&d.find("b.frm_suffix").size()<=0){J.val(J.val().split("@")[0]);h()}});d.bind("submit",function(){var J=d.find("input[name='mail']").val();if(J&&J.length>0){if(t.test("atsohumail",J)){d.attr("action","/regist/newSohuRegist")}else{d.attr("action","/regist/otherDomainRegist")}}})});